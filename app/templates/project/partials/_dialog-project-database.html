{% from "macros/dialog.html" import dialog %}
{% from "macros/tabs.html" import tabs %}

{% call dialog(
  id="dialog-project-database",
  title=_("Connect a database"),
  description=_("Create a new SQLite database or connect an existing one to this project."),
  dialog_attrs={"class": "w-full max-w-xl"},
  body_attrs={"class": "space-y-4"}
) %}

{% if available_databases | length > 0%}
  {% set create_database_panel %}
    {% with form=create_database_form, databases=None, fragment="create_database" %}
      {% include "project/partials/_dialog-project-database-form.html" with context %}
    {% endwith %}
  {% endset %}

  {% set connect_database_panel %}
    {% with form=connect_database_form, databases=available_databases, fragment="connect_database" %}
      {% include "project/partials/_dialog-project-database-form.html" with context %}
    {% endwith %}
  {% endset %}

  {{ tabs(
    tabsets=[
      {
        "id": "create-database",
        "tab": _("Create new"),
        "panel": create_database_panel,
        "panel_attrs": {"class": "pt-4"}
      },
      {
        "id": "connect-database",
        "tab": _("Connect existing"),
        "panel": connect_database_panel,
        "panel_attrs": {"class": "pt-4"}
      }
    ],
    main_attrs={"class": "w-full"},
    tablist_attrs={"class": "w-full"}
  ) }}
{% else %}
  {% with form=create_database_form, databases=None, fragment="create_database" %}
    {% include "project/partials/_dialog-project-database-form.html" with context %}
  {% endwith %}
{% endif %}
{% endcall %}
